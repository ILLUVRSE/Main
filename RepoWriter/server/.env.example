# RepoWriter - Server example env file
# Copy to RepoWriter/server/.env and fill values (do NOT commit the real .env)

########################################
# Core runtime
########################################
# Port the server listens on
PORT=7071

# Path to the repository root that RepoWriter will operate on.
# Use an absolute path in production. For local dev ./ is usually fine.
REPO_PATH=/absolute/path/to/your/repo/root

# Git config used for commits created by RepoWriter
GITHUB_REMOTE=origin
GIT_USER_NAME=RepoWriter CI
GIT_USER_EMAIL=repowriter@example.com

NODE_ENV=development

########################################
# OpenAI / LLM settings (used by planner/stream)
########################################
# Real OpenAI key (do NOT commit). If using a local mock set OPENAI_API_URL instead.
OPENAI_API_KEY=
# Optional override for OpenAI base URL (use for local mock)
OPENAI_API_URL=http://127.0.0.1:9876
OPENAI_PROJECT_ID=

# Controls dev/CI behavior: when set to 1, allow endpoints to run without OPENAI_API_KEY
# (dev convenience). Prefer using OPENAI_API_URL to point at a mock instead.
REPOWRITER_ALLOW_NO_KEY=0

# Enable sandbox/CI mode (allows sandbox runner usage)
SANDBOX_ENABLED=1

########################################
# Signing / KMS (Task 1)
########################################
# HMAC secret used only for local/CI fallback. Keep this secret and rotate as needed.
# Default shown here is for local dev. NEVER use this in production.
REPOWRITER_SIGNING_SECRET=repowriter-dev-secret

# Signing proxy / KMS URL. When set, RepoWriter will attempt to call:
#   POST $SIGNING_PROXY_URL/sign { payload_b64 }
# and expect: { signature_b64, signer_id }.
# Example: https://signer.internal.corp
SIGNING_PROXY_URL=

# Optional API key (or bearer token) for the signing proxy.
SIGNING_PROXY_API_KEY=

# If set to 1, RepoWriter will *fail closed* when signing proxy fails (no HMAC fallback).
# Recommended: set REQUIRE_SIGNING_PROXY=1 in production and ensure SIGNING_PROXY_URL is configured.
REQUIRE_SIGNING_PROXY=0

########################################
# Runtime & telemetry
########################################
LOG_LEVEL=info
# Optional telemetry endpoint (if you have a metrics / audit sink)
TELEMETRY_ENDPOINT=

########################################
# Security / production
########################################
# When deploying to production:
#  - set NODE_ENV=production
#  - configure SIGNING_PROXY_URL and SIGNING_PROXY_API_KEY
#  - set REQUIRE_SIGNING_PROXY=1 to enforce KMS usage
#  - ensure REPO_PATH, GIT creds and TELEMETRY_ENDPOINT are correctly configured
#
# Example production settings (do NOT put secrets in this file committed to git):
# NODE_ENV=production
# SIGNING_PROXY_URL=https://signer.prod.internal
# SIGNING_PROXY_API_KEY=sk-...
# REQUIRE_SIGNING_PROXY=1

########################################
# End .env.example
########################################

